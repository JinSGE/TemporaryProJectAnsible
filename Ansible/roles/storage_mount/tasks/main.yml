# =================================================================
# κ³µν†µ μ¤ν† λ¦¬μ§€ μΈν”„λΌ κµ¬μ¶• (NFS Client)
# [Physical Architecture: VMware λ‚΄λ¶€ 5λ€ μ„λ²„ κ°„ λ°μ΄ν„° κ³µμ λ¥Ό μ„ν• μ¤ν† λ¦¬μ§€ κ³„μΈµ]
# - λ¨λ“  μ„λ²„(API, DB, Web λ“±)κ°€ λ™μΌν• μ†μ¤ λ°μ΄ν„°λ¥Ό μ°Έμ΅°ν•  μ μλ” κΈ°λ°μ„ λ§λ ¨.
# =================================================================
- name: 1. NFS ν΄λΌμ΄μ–ΈνΈ μ ν‹Έλ¦¬ν‹° μ„¤μΉ
  # [Physical Architecture: λ„¤νΈμ›ν¬ νμΌ μ‹μ¤ν… ν†µμ‹ μ„ μ„ν• ν•„μ ν¨ν‚¤μ§€ κµ¬μ„±]
  # - nfs-utils: NFS ν”„λ΅ν† μ½μ„ μ΄μ©ν•΄ μ™Έλ¶€ NASμ— μ ‘κ·Όν•κΈ° μ„ν• ν΄λΌμ΄μ–ΈνΈ λ„κµ¬.
  ansible.builtin.dnf:
    name: nfs-utils
    state: present
    update_cache: yes # μµμ‹  μΈλ±μ¤ λ°μμΌλ΅ ν¨ν‚¤μ§€ λ„λ½ μ¶©λ λ°©μ§€

- name: 2. NAS μ¤ν† λ¦¬μ§€ λ§μ΄νΈ λ””λ ‰ν† λ¦¬ μƒμ„±
  # [Physical Architecture: λ΅μ»¬ νμΌ μ‹μ¤ν… λ‚΄ λ§μ΄νΈ ν¬μΈνΈ ν™•λ³΄]
  ansible.builtin.file:
    path: /mnt/nas_shared
    state: directory
    owner: root
    group: root
    mode: '0755'

- name: 3. NAS μ¤ν† λ¦¬μ§€ λ§μ΄νΈ λ° /etc/fstab λ“±λ΅
  # [Logical Architecture: μ¤‘μ•™ λ°μ΄ν„° μ²λ¦¬(Center) λ° API(Left) κ°„μ λ°μ΄ν„° μ •ν•©μ„± μ μ§€]
  # - Physical: 172.16.6.100 NAS μ„λ²„μ™€ VMware λ‚΄λ¶€λ§ μ—°κ²°
  # - state: mounted (μ§€κΈ μ¦‰μ‹ λ§μ΄νΈν•κ³ , λ¶€ν… μ‹μ—λ„ μλ™ λ§μ΄νΈλλ„λ΅ μ„¤μ •)
  ansible.posix.mount:
    path: /mnt/nas_shared
    src: 172.16.6.100:/exports/data # [μμ • ν•„μ”] μ‹¤μ  NAS μ„λ²„μ IPμ™€ λ‚΄λ³΄λ‚΄κΈ° κ²½λ΅
    fstype: nfs
    opts: rw,sync,hard # μ½κΈ°/μ“°κΈ° κ¶ν• λ° λ°μ΄ν„° λ¬΄κ²°μ„±μ„ μ„ν• μµμ…
    state: mounted

# =================================================================
# π’΅ ν•μ΄λΈλ¦¬λ“ ν΄λΌμ°λ“ κ³ λ ¤ μ‚¬ν•­
# =================================================================
# - λ‚μ¤‘μ— AWS Cloudμ™€ μ—°κ²°ν•  λ•, μ΄ κ³µμ  λ””λ ‰ν† λ¦¬λ” AWS EFS(Elastic File System)μ™€
#   λ°μ΄ν„° λ™κΈ°ν™”(DataSync)λ¥Ό μν–‰ν•λ” ν•µμ‹¬ μ§€μ .