---
- name: 1. API 컨테이너 실행 (Weather API)
  docker_container:
    name: weather-api
    image: fastapi-weather:latest  # 실제 이미지 이름으로 수정
    state: started
    published_ports: "8001:8000"

- name: 2. API 컨테이너 실행 (Logistics API)
  docker_container:
    name: logistics-api
    image: fastapi-logistics:latest
    state: started
    published_ports: "8002:8000"

- name: 3. API 컨테이너 실행 (Energy API)
  docker_container:
    name: energy-api
    image: fastapi-energy:latest
    state: started
    published_ports: "8003:8000"


# # roles/api_deploy/tasks/main.yml (변수 활용 버전)
# - name: API 컨테이너들을 일괄 실행합니다
#   docker_container:
#     name: "{{ item.name }}"
#     image: "{{ item.image }}"
#     state: started
#     restart_policy: always
#     published_ports:
#       - "{{ item.host_port }}:{{ api_internal_port }}"
#   loop: "{{ deploy_apis }}"  # host_vars에 정의한 리스트를 순회합니다.